---
import Layout from '../layouts/Layout.astro';
import BookingEngine from '../components/BookingEngine.astro';
import { fetchDatoCMS } from '../lib/datocms';

// Consulta a DatoCMS
const query = `
{
  allSliders(orderBy: _createdAt_ASC) {
    id
    media {
      url
    }
    description
  }
}
`;
const data = await fetchDatoCMS(query);
const slides = data.allSliders || [];
---

<Layout title="Welcome to La Casa Que Canta">
  <section class="scroll-section grid relative">
    <div class="absolute top-20 right-8 z-10">
      <img class="hidden md:block" src="/logo-white.svg" width="115px" alt="">
    </div>

    <!-- Slider Desktop -->
    <div class="hidden md:block absolute top-0 left-0 w-full h-full overflow-hidden">
      <div class="swiper mySwiper w-full h-full">
        <div class="swiper-wrapper">
          {slides.map((slide) => (
            <div class="swiper-slide">
              <img src={slide.media.url} class="w-full h-full object-cover" alt={slide.description || 'Slide'} />
            </div>
          ))}
        </div>
        <div class="swiper-pagination"></div>
      </div>
    </div>

    <!-- Slider Mobile -->
    <div class="md:!hidden swiper mySwiper !absolute h-full w-full top-0 overflow-hidden aspect-[16/6]">
      <div class="swiper-wrapper">
        {slides.map((slide) => (
          <div class="swiper-slide">
            <img src={slide.media.url} class="w-full h-full object-cover" alt={slide.description || 'Slide'} />
          </div>
        ))}
      </div>
      <div class="swiper-pagination"></div>
    </div>

    <!-- Contenido -->
    <div class="relative pt-24 md:pt-4 z-10 w-full text-center">
      <div class="mix-blend-difference">
        <h1 class="relative text-4xl md:text-4xl lg:text-5xl xl:text-7xl text-white font-bold">
          La Casa que canta
        </h1>
      </div>
    </div>

    <div class="px-4 relative z-10 py-4 flex flex-col justify-end gap-y-16">
      <div></div>
      <div class="flex flex-wrap justify-between gap-6 items-end">
        <div class="flex flex-col flex-wrap items-center gap-1 flex-grow">
          <BookingEngine/>
          <p class="uppercase text-white font-semibold text-xs">
            zihuatanejo, guerrero mexico.pueblo m√°gico.
            <a href="mailto:sales.reservations@lacasaquecanta.com">sales.reservations@lacasaquecanta.com</a>
          </p>
        </div>
        <div class="flex gap-3">
          <a href="https://www.facebook.com/LaCasaQueCantaLuxuryHotel/" target="_blank">
            <svg class="fill-white" role="img" width="20" height="20" viewBox="0 0 24 24">
              <title>Facebook</title>
              <path d="M9.101 23.691v-7.98H6.627v-3.667h2.474v-1.58c0-4.085 1.848-5.978 5.858-5.978..."/>
            </svg>
          </a>
          <a href="https://www.instagram.com/lacasaquecanta_hotelboutique/" target="_blank">
            <svg class="fill-white" role="img" width="20" height="20" viewBox="0 0 24 24">
              <title>Instagram</title>
              <path d="M7.03.084c-1.27.06-2.15.26-2.91.56-.79.31-1.46.72-2.12 1.39..."/>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Script Swiper -->
  <script>
    import Swiper from "swiper";
    import { Pagination, Autoplay } from "swiper/modules";

    import "swiper/css";
    import "swiper/css/pagination";

    new Swiper(".mySwiper", {
      modules: [Pagination, Autoplay],
      pagination: { el: ".swiper-pagination", clickable: true },
      autoplay: { delay: 5000, disableOnInteraction: false },
      loop: true,
    });
  </script>

  <style is:global>
    .scroll-section {
      height: 100vh;
      position: relative;
    }
    .swiper, .swiper-slide {
      width: 100%;
      height: 100%;
    }
  </style>
</Layout>
